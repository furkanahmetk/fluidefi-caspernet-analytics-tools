# For more information, please refer to https://aka.ms/vscode-docker-python
FROM fluidefi-app

ARG READ_DB_CONNECTION_HOST
ENV READ_DB_CONNECTION_HOST=$READ_DB_CONNECTION_HOST

ARG READ_DB_CONNECTION_DATABASE
ENV READ_DB_CONNECTION_DATABASE=$READ_DB_CONNECTION_DATABASE

ARG READ_DB_CONNECTION_USERNAME
ENV READ_DB_CONNECTION_USERNAME=$READ_DB_CONNECTION_USERNAME

ARG READ_DB_CONNECTION_PASSWORD
ENV READ_DB_CONNECTION_PASSWORD=$READ_DB_CONNECTION_PASSWORD

ARG READ_DB_CONNECTION_PORT
ENV READ_DB_CONNECTION_PORT=$READ_DB_CONNECTION_PORT

ARG WRITE_DB_CONNECTION_HOST
ENV WRITE_DB_CONNECTION_HOST=$WRITE_DB_CONNECTION_HOST

ARG WRITE_DB_CONNECTION_DATABASE
ENV WRITE_DB_CONNECTION_DATABASE=$WRITE_DB_CONNECTION_DATABASE

ARG WRITE_DB_CONNECTION_USERNAME
ENV WRITE_DB_CONNECTION_USERNAME=$WRITE_DB_CONNECTION_USERNAME

ARG WRITE_DB_CONNECTION_PASSWORD
ENV WRITE_DB_CONNECTION_PASSWORD=$WRITE_DB_CONNECTION_PASSWORD

ARG WRITE_DB_CONNECTION_PORT
ENV WRITE_DB_CONNECTION_PORT=$WRITE_DB_CONNECTION_PORT

#  Run Migrations and then start the service
ENTRYPOINT ["/bin/sh", "-c", "python3 manage.py migrate cspr_summarization && python3 block_summarizer.py" ] 



